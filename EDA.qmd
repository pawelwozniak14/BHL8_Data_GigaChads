---
title: "EDA"
format: html
---

# Exploratory Data Analysis 

```{r}
data <- readRDS("data/eda_data.rds")
c(
nrow(data[which(data$TWF + data$HDF + data$PWF + data$OSF + data$RNF >= 2),]),
nrow(data[which(data$TWF + data$HDF + data$PWF + data$OSF + data$RNF >= 3),]),
nrow(data[which(data$TWF + data$HDF + data$PWF + data$OSF + data$RNF >= 4),]),
nrow(data[which(data$TWF + data$HDF + data$PWF + data$OSF + data$RNF >= 5),]))
```


```{r}
library(tidyverse)
load("data/model_data.rda")

model_data %>%
  mutate(Machine_failure=ifelse(Machine_failure==1,"Yes","No")) %>%
  ggplot(aes(y=Machine_failure,x=Tool_wear,fill=Machine_failure))+
    geom_boxplot(show.legend = FALSE)+
    labs(x="Tool wear[min]", y="Failure occured")+
    scale_fill_manual(values = c("blue","red"))+
    theme_classic(base_size = 15)

failures <- data.frame(failure_type=c("TWF","HWD","PWF","OSF","RNF"),sum=c(sum(data$TWF),sum(data$HDF),sum(data$PWF),sum(data$OSF),sum(data$RNF)))

failures$failure_type <- as.factor(failures$failure_type)

# sum(failures$sum)-sum(as.numeric(data$Machine_failure)-1)
# 
# data[which(data$Machine_failure==0 & (data$TWF + data$HDF + data$PWF + data$OSF + data$RNF != 0)),]
# 
# data[which(data$RNF==1),]

failures %>%
  ggplot(aes(x=reorder(failure_type, -sum),y=sum,fill=failure_type))+
  geom_col()+
  geom_hline(yintercept = seq(30,120,by=30), linetype = "dashed", color = "black", alpha = 0.4, size=0.3)+
  scale_y_continuous(breaks = seq(30,120,by=30))+
  labs(x="Failure Type",y="Number of occurances")+
  scale_fill_brewer(palette = "Dark2")+
  theme_classic()
```

